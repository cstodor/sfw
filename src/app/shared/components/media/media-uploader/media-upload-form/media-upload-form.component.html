<div class="dropZone"
     dropZone
     (filesDropped)="handleDrop($event)"
     (filesHovered)="dropZoneState($event)"
     [ngClass]="{'active': dropZoneActive}"
     [formGroup]="form">
  <div class="file">
    <label class="file-label">
      <input type="file"
             formControlName="imageUrl"
             (change)="onFileChange($event)"
             [multiple]="uploaderConfig.multiple">
      <button *ngIf="!uploaderConfig.autoUpload && currentUploads.length === 1"
              type="button"
              (click)="uploadFiles()">
        {{('general.media.uploadFile' | translate)}}
      </button>
      <!--<span class="file-cta">
        <span class="file-icon">
          <i class="fa fa-upload"></i>
        </span>
        <span class="file-label">or choose a fileâ€¦</span>
      </span>-->
      <br />
      <mat-progress-bar
        *ngIf="currentUploads.length === 1"
        style="margin-top: 15px;"
        class="singleUploadProgress"
        mode="determinate"
        value="{{ currentUploads[0]?.percentageChanges }}">
      </mat-progress-bar>
    </label>

    <!--<a class="image-uploader-unsplash">
      <mat-icon>add_a_photo</mat-icon>
    </a>

    <a title="Delete" *ngIf="currentImageUrl" class="image-cancel" (click)="deleteMedia(currentImageUrl)">
      <mat-icon>delete</mat-icon>
    </a>-->
  </div>

</div>

<div *ngIf="uploaderConfig.showQueue && currentUploads.length > 1"
     style="margin-top: 25px;">

  <div fxLayout="row"
       fxLayoutWrap="wrap"
       class="aligner"
       style="margin: 5px 0"
       *ngFor="let upload of currentUploads">

    <div fxFlex="18">{{upload?.file.name}}</div>
    <div fxFlex="4">{{upload?.file.size | fileSize}}</div>
    <div fxFlex="8">{{upload?.percentageChanges ? upload?.percentageChanges : 0}}% Complete</div>

    <div fxFlex="35" fxFlexOffset="2">
      <mat-progress-bar
        mode="determinate"
        value="{{ upload?.percentageChanges }}">
      </mat-progress-bar>
    </div>

    <div fxFlex="5" *ngIf="(state$ | async) || 'idle' as state">

      Upload State:
      <p class="tag"
         [ngClass]="{
        'is-success':  state === 'success',
        'is-info':     state === 'running',
        'is-warning':  state === 'paused',
        'is-danger':   state === 'error'
      }">
        {{ state }}
      </p>
    </div>

    <div fxFlex="26" fxFlexOffset="2" *ngIf="!upload.isCompleted">
      <button *ngIf="!upload.isPaused"
              type="button"
              (click)="pauseUpload(upload)"
              mat-raised-button
              color="primary">
        {{ 'general.media.resumeUpload' | translate}}
      </button>

      <button *ngIf="upload.isPaused"
              type="button"
              (click)="resumeUpload(upload)"
              mat-raised-button
              color="primary">
        {{ 'general.media.pauseUpload' | translate}}
      </button>

      <button (click)="deleteFromQueue(upload)"
              type="button"
              mat-raised-button
              color="warn">
        {{'general.media.cancelUpload' | translate}}
      </button>
    </div>

  </div>

</div>

<div fxLayout="row"
     fxLayoutWrap="wrap"
     class="aligner"
     style="margin: 25px 0"
     *ngIf="currentUploads.length > 1">

  <div fxFlex="100">

    <div class="button-row" *ngIf="currentUploads.length > 1">
      <button (click)="uploadFiles()"
              mat-raised-button
              color="primary">
        {{'general.media.uploadAll' | translate}}
      </button>
      <button (click)="clearQueue()"
              mat-raised-button
              color="accent">
        {{'general.media.clearQueue' | translate}}
      </button>
    </div>
  </div>
</div>
